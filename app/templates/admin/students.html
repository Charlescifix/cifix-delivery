{% extends "base.html" %}

{% block content %}
<div class="py-8">
    <div class="max-w-7xl mx-auto px-4">
        <!-- Header -->
        <div class="modern-card mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="title-secondary mb-2 flex items-center gap-3">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                        </div>
                        Manage Students
                    </h1>
                    <p class="text-gray-600 text-lg">Add and manage student accounts</p>
                </div>
                <div class="flex gap-3">
                    <a href="/admin/dashboard" class="modern-btn-secondary">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
                        </svg>
                        Admin Dashboard
                    </a>
                    <a href="/logout" class="modern-btn-danger">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z" />
                        </svg>
                        Logout
                    </a>
                    <a href="/" class="modern-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10,20V14H14V20V21H10V20M12,1L21,5V11C21,16.55 17.16,21.74 12,23C6.84,21.74 3,16.55 3,11V5L12,1Z" />
                        </svg>
                        Main Site
                    </a>
                </div>
            </div>
        </div>

        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Add New Student Form -->
            <div class="modern-card">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-green-600">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    Add New Student
                </h2>
                
                <form method="post" class="space-y-6">
                    <div>
                        <label class="modern-label">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="inline mr-2">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                            First Name
                        </label>
                        <input type="text" name="first_name" placeholder="e.g., Alex" 
                               class="modern-input" required>
                    </div>

                    <div>
                        <label class="modern-label">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="inline mr-2">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            Age
                        </label>
                        <input type="number" name="age" placeholder="8" min="3" max="18" 
                               class="modern-input" required>
                    </div>

                    <div>
                        <label class="modern-label">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="inline mr-2">
                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                            </svg>
                            Parent Email
                        </label>
                        <input type="email" name="parent_email" placeholder="parent@example.com" 
                               class="modern-input" required>
                    </div>

                    <div>
                        <label class="modern-label">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="inline mr-2">
                                <path d="M18,8A6,6 0 0,0 12,2A6,6 0 0,0 6,8H4C2.89,8 2,8.89 2,10V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V10C22,8.89 21.11,8 20,8H18M12,4A4,4 0 0,1 16,8H8A4,4 0 0,1 12,4Z" />
                            </svg>
                            Access Code
                        </label>
                        <input type="text" name="access_code" placeholder="e.g., KID001" 
                               class="modern-input" required>
                        <p class="text-sm text-gray-500 mt-2">Must be unique for each student</p>
                    </div>

                    <div>
                        <label class="modern-label">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="inline mr-2">
                                <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
                            </svg>
                            Class Label (Optional)
                        </label>
                        <input type="text" name="class_label" placeholder="e.g., Beginners Group A" 
                               class="modern-input">
                    </div>

                    <button type="submit" class="modern-btn w-full">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        Add Student
                    </button>
                </form>
            </div>

            <!-- Existing Students -->
            <div class="modern-card">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-blue-600">
                        <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zM4 18v-4h3v-3c0-1.1.9-2 2-2h2c1.1 0 2 .9 2 2v7H4zm9-6.5c0-.83-.67-1.5-1.5-1.5S10 10.67 10 11.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5zM7.5 11.5c0-.83-.67-1.5-1.5-1.5S4.5 10.67 4.5 11.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5z"/>
                    </svg>
                    All Students ({{ students|length }})
                </h2>
                
                <div class="overflow-x-auto max-h-96">
                    {% if students %}
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-gray-200">
                                <th class="text-left py-3 px-2 font-semibold text-gray-700">Name</th>
                                <th class="text-left py-3 px-2 font-semibold text-gray-700">Age</th>
                                <th class="text-left py-3 px-2 font-semibold text-gray-700">Access Code</th>
                                <th class="text-left py-3 px-2 font-semibold text-gray-700">Class</th>
                                <th class="text-left py-3 px-2 font-semibold text-gray-700">Joined</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                            <tr class="border-b border-gray-100 hover:bg-gray-50">
                                <td class="py-3 px-2 font-medium">{{ student.first_name }}</td>
                                <td class="py-3 px-2">{{ student.age or 'N/A' }}</td>
                                <td class="py-3 px-2">
                                    <code class="bg-gray-100 px-2 py-1 rounded text-sm">{{ student.access_code }}</code>
                                </td>
                                <td class="py-3 px-2 text-gray-600">{{ student.class_label or '-' }}</td>
                                <td class="py-3 px-2 text-gray-600">{{ student.created_at.strftime('%Y-%m-%d') }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <div class="text-center py-12">
                        <div class="w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor" class="text-gray-400">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                        </div>
                        <p class="text-gray-500 text-lg">No students registered yet</p>
                        <p class="text-gray-400">Add your first student using the form!</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Bulk Actions -->
        <div class="modern-card mt-8">
            <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-indigo-600">
                    <path d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                Bulk Actions
            </h2>
            <div class="grid md:grid-cols-3 gap-4">
                <a href="/admin/assessments.csv" class="modern-btn-success text-center p-6">
                    <div class="flex flex-col items-center gap-2">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L20.71,8.71L23,11V6H16Z" />
                        </svg>
                        <span>Export All Data</span>
                    </div>
                </a>
                <button class="modern-btn-secondary text-center p-6" onclick="generateCodes()">
                    <div class="flex flex-col items-center gap-2">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18,8A6,6 0 0,0 12,2A6,6 0 0,0 6,8H4C2.89,8 2,8.89 2,10V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V10C22,8.89 21.11,8 20,8H18M12,4A4,4 0 0,1 16,8H8A4,4 0 0,1 12,4Z" />
                        </svg>
                        <span>Generate Codes</span>
                    </div>
                </button>
                <button class="modern-btn-secondary text-center p-6" onclick="showStudentStats()">
                    <div class="flex flex-col items-center gap-2">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L20.71,8.71L23,11V6H16Z" />
                        </svg>
                        <span>View Statistics</span>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    function generateCodes() {
        alert('Feature coming soon: Bulk generate unique access codes for multiple students');
    }
    
    function showStudentStats() {
        alert('Feature coming soon: View detailed student progress statistics');
    }
</script>
{% endblock %}